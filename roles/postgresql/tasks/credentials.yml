- name: Create a directory if it does not exist
  ansible.builtin.file:
    path: "{{ postgresql_credentials_dir }}/databases"
    state: directory
    mode: '0700'

- template:
    src:  "database.json.jinja2"
    dest: "{{ postgresql_credentials_dir }}/databases/{{ item.namespace}}-{{ item.name }}.json"
  loop: "{{ postgresql_databases }}"
